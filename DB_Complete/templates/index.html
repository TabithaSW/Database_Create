<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Specifies the character encoding of the HTML document -->
    <meta charset="UTF-8"> 

    <!-- Makes the page responsive by setting the viewport width to the device's width -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 

    <!-- Title that appears in the browser tab -->
    <title>Lightweight DBMS</title> 

    <!-- Links the external CSS stylesheet located in the static folder -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"> 

    <!-- Links the jQuery library for simplifying JavaScript tasks -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
</head>
<body>
    <!-- Header section at the top of the page -->
    <header>
        <!-- Main title of the application -->
        <h1>Light Weight DBMS</h1>
    </header>

    <!-- Main content section of the page -->
    <main>
        <!-- Left box for user input -->
        <div id="query-box">
            <h2>Submit SQL Query</h2> <!-- Subheading for the query section -->
            
            <!-- Textarea where users input SQL queries -->
            <textarea id="query-input" placeholder="Enter your SQL query here:"></textarea>

            <!-- Button to execute the SQL query -->
            <button id="submit-query">Execute Query</button>

            <!-- Button to export and close the database -->
            <button id="close-db">Export & Close Database</button>
        </div>

        <!-- Right box for displaying query results -->
        <div id="data-box">
            <h2>Database Output</h2> <!-- Subheading for the output section -->
            
            <!-- Container to display the query output -->
            <div id="output"></div>
        </div>
    </main>

    <!-- Footer section at the bottom of the page -->
    <footer>
        <!-- Attribution message in the footer -->
        <p>Powered by My Lightweight DBMS</p>
    </footer>

    <!-- JavaScript section for handling user interactions -->
    <script>
        // Handles the submission of a query when the "Execute Query" button is clicked
        $('#submit-query').click(function () {
            const query = $('#query-input').val(); // Gets the user's input from the textarea
            
            // Sends the query to the Flask server's /execute endpoint
            $.post('/execute', { query: query }, function (data) {
                if (data.success) {
                    // If the query succeeds, display the result in a formatted way
                    $('#output').html(`<pre>${JSON.stringify(data.result, null, 2)}</pre>`);
                } else {
                    // If there is an error, display the error message in red
                    $('#output').html(`<p style="color: red;">Error: ${data.error}</p>`);
                }
            });
        });

        // Handles closing and exporting the database when the "Export & Close Database" button is clicked
        $('#close-db').click(function () {
            // Sends a request to the Flask server's /close endpoint
            $.post('/close', {}, function (data) {
                if (data.success) {
                    // If successful, show a success message
                    alert(data.message);
                } else {
                    // If there is an error, show the error message
                    alert(`Error: ${data.error}`);
                }
            });
        });
    </script>
</body>
</html>
